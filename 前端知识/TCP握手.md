第一步：
客户端的TCP向服务器端的TCP发送一个TCP报文段。
该报文段不包含应用层数据。但是报文段首部的SYN被设置为1。
这个报文段也被称为SYN报文段段。并且会在这个报文段的序号字段中会被放入一个随机初始序号。

第二步：
当这个包含SYN报文段的IP数据到达了服务器主机后。
服务器会从这个IP数据中提取出TCP SYN报文段，并为这个TCP连接分配TCP缓存和变量，然后向客户TCP发送允许连接的报文段。
那这个报文段也不包含应用层数据。它的SYN依旧是1，并且会选择自己的一个初始序号。最后还会附加一个确认号，也就是ACK，那么这个ACK的值，是客户端当时所生的随机初始序号+1.

第三步：
客户端收到后，也会给这个TCP连接分配缓存和变量。并返回一个TCP报文段。这个报文段的SYN变为0，序列号是客户端一开始生成的序列号+1，再附加一个ACK，这个ACK的值是服务器端的序列号+1.

客户端                       服务端
SYN=1,seq=client_seq

                            SYN=1,seq=server_seq,ACK=client_seq+1

SYN=0,seq=client_seq+1,ACK=server_seq+1

这三个步骤完成之后，就可以开始相互发送包含数据的报文段了。之后的SYN一般都会被设置为0。这整个流程一般是三步，所以也就被称为三次握手。



四次挥手
第一步：
客户端会向服务器发送一个标志位为FIN的报文段，FIN比特被设置为1.
第二步：
服务器收到后，会发送一个确认报文段ACK。
第三步：
之后服务器也向客户端发送一个终止报文段，标志位也为FIN，FIN比特也是1.
第四步：
客户对从服务器收到的终止报文段进行确认，发送确认字段ACK。

至此四次挥手就结束了。两台主机也会各自释放所有资源。

客户端                         服务端
FIN=1,seq=u
                              ACK=1,seq=v,ack=u+1
                              FIN=1,ACK=1,seq=w,ack=u+1
ACK=1,seq=u+1,ack=w+1
